# aws-soc2-non-prod Infrastructure Stack

## Overview
This stack uses Iltero's **Self-Contained Unit Architecture** where each
infrastructure unit contains all terraform files needed for deployment,
plus environment-specific configuration.

## Quick Start

```bash
# Navigate to a unit
cd units/network-baseline

# Initialize with environment-specific backend
terraform init -backend-config="config/backend/development.hcl"

# Plan with environment-specific variables
terraform plan -var-file="config/development.tfvars"

# Apply
terraform apply -var-file="config/development.tfvars"
```

## Infrastructure Units
This stack consists of 3 self-contained infrastructure units:
- **network-baseline**
- **security-baseline**
- **monitoring-baseline**

## Architecture
```
infra/stacks/aws-soc2-non-prod/
├── config.yml                 # CI/CD orchestration
├── README.md
└── units/                     # Self-contained infrastructure units
│   ├── network-baseline/
│   │   ├── main.tf
│   │   ├── variables.tf
│   │   ├── outputs.tf
│   │   ├── data.tf
│   │   ├── backend.tf
│   │   ├── providers.tf
│   │   ├── versions.tf
│   │   └── config/
│   │       ├── development.tfvars
│   │       ├── staging.tfvars
│   │       ├── production.tfvars
│   │       └── backend/
│   │           ├── development.hcl
│   │           ├── staging.hcl
│   │           └── production.hcl
│   ├── security-baseline/
│   │   ├── main.tf
│   │   ├── variables.tf
│   │   ├── outputs.tf
│   │   ├── data.tf
│   │   ├── backend.tf
│   │   ├── providers.tf
│   │   ├── versions.tf
│   │   └── config/
│   │       ├── development.tfvars
│   │       ├── staging.tfvars
│   │       ├── production.tfvars
│   │       └── backend/
│   │           ├── development.hcl
│   │           ├── staging.hcl
│   │           └── production.hcl
│   ├── monitoring-baseline/
│   │   ├── main.tf
│   │   ├── variables.tf
│   │   ├── outputs.tf
│   │   ├── data.tf
│   │   ├── backend.tf
│   │   ├── providers.tf
│   │   ├── versions.tf
│   │   └── config/
│   │       ├── development.tfvars
│   │       ├── staging.tfvars
│   │       ├── production.tfvars
│   │       └── backend/
│   │           ├── development.hcl
│   │           ├── staging.hcl
│   │           └── production.hcl
```

## Unit Structure
Each infrastructure unit is **self-contained** with:
- `main.tf`: Module invocation
- `variables.tf`: All input variables (module + provider + state)
- `outputs.tf`: Exported values for other units
- `data.tf`: Cross-unit dependencies (terraform_remote_state)
- `backend.tf`: Backend configuration block
- `providers.tf`: Provider configuration (parameterized via variables)
- `versions.tf`: Terraform and provider version constraints
- `config/`: Environment-specific configuration
  - `{env}.tfvars`: Variable values per environment
  - `backend/{env}.hcl`: Backend configuration per environment

## Template Bundle Integration
- **Template ID**: technology-aws-modern-stack
- **Template Version**: 1.0.0
- **Bootstrap Type**: Self-Contained Units with Template Bundle Marketplace

## Infrastructure Unit Coordination (UIC)
Units are coordinated through UIC contracts:
- **Provides**: Resources and outputs each unit makes available
- **Requires**: Dependencies each unit needs from other units
- **Deployment Order**: Sequence for terraform apply operations

### Unit Dependencies
- **network-baseline**: requires [] | provides []
- **security-baseline**: requires [] | provides []
- **monitoring-baseline**: requires [] | provides []

## Deployment

### Local Development
```bash
cd units/<unit-name>
terraform init -backend-config="config/backend/development.hcl"
terraform plan -var-file="config/development.tfvars"
terraform apply -var-file="config/development.tfvars"
```

### CI/CD (GitHub Actions)
Deployment is automatic through GitHub Actions when:
1. Changes are pushed to the repository
2. Platform workflows detect changes in this stack
3. Compliance scanning passes
4. Required approvals are obtained (for production)

## Compliance Integration
Compliance is enforced at scan-time:
- CLI calls `POST /v1/compliance/resolve-policies` before each scan
- Policies are resolved from registry based on compliance frameworks
- Results are submitted with manifest hash for provenance tracking

## Configuration Management
- **DO NOT** edit workflow files directly
- All behavior is controlled through `config.yml`
- Environment configurations are in `units/<name>/config/`
- Variable precedence: Compliance > Module Interface > Context

## Support
For assistance, contact your platform administrator or refer to the
Iltero documentation at https://docs.iltero.com

---
Generated by Iltero Self-Contained Unit Bootstrap System
Template Bundle ID: technology-aws-modern-stack
Generated at: 2026-01-04T08:04:13.741391+00:00
